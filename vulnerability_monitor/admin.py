from django.contrib import admin
from django.utils.html import format_html
from django.contrib.admin import register
from .models import *

@register(XSSReport)
class XSSReportAdmin (admin.ModelAdmin):
    list_display = ['asset', 'method' , 'protocol' , 'level', 'injection_place' , 'label' ,'short_url']
    list_filter = ['method' , 'protocol' , 'level' , 'label','injection_place']
    search_fields = ['asset']
    
    ordering = ['-created_at']
    
    def short_url(self, obj):
        return format_html('<a href="{}" target="_blank">Click here</a>', obj.url)
    short_url.short_description = 'URL'



@register(NucleiReport)
class NucleiReportAdmin(admin.ModelAdmin):
    list_display = ['template_id' , 'severity' , 'type' ,'tags', 'host', 'port' , 'label']
    list_filter = ['severity' , 'type' , 'port']
    search_fields = ['template_id' , 'host', 'template_name' , 'extracted_results' , 'ip']

    ordering = ['-created_at']